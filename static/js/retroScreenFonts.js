//////////////////////
// RETROSCREEN FONTS//
//////////////////////

(function () {
    var DEFAULT_FONT = {
            charset:     'ABCDEFGHIJKLMNOPQRSTUVWXYZ"\'`-_/1234567890!?[](){}.,;:<>+=%#^*~ ',
            charW:       4,
            charH:       6,
            transparent: 0,
            uppercase:   true,
            chars:       {"0":[[7,7,7,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"1":[[7,7,0,0],[0,7,0,0],[0,7,0,0],[0,7,0,0],[7,7,7,0],[0,0,0,0]],"2":[[7,7,7,0],[0,0,7,0],[7,7,7,0],[7,0,0,0],[7,7,7,0],[0,0,0,0]],"3":[[7,7,7,0],[0,0,7,0],[0,7,7,0],[0,0,7,0],[7,7,7,0],[0,0,0,0]],"4":[[7,0,7,0],[7,0,7,0],[7,7,7,0],[0,0,7,0],[0,0,7,0],[0,0,0,0]],"5":[[7,7,7,0],[7,0,0,0],[7,7,7,0],[0,0,7,0],[7,7,7,0],[0,0,0,0]],"6":[[7,7,7,0],[7,0,0,0],[7,7,7,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"7":[[7,7,7,0],[0,0,7,0],[0,0,7,0],[0,0,7,0],[0,0,7,0],[0,0,0,0]],"8":[[7,7,7,0],[7,0,7,0],[7,7,7,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"9":[[7,7,7,0],[7,0,7,0],[7,7,7,0],[0,0,7,0],[7,7,7,0],[0,0,0,0]],"A":[[7,7,7,0],[7,0,7,0],[7,7,7,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"B":[[7,7,7,0],[7,0,7,0],[7,7,0,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"C":[[0,7,7,0],[7,0,0,0],[7,0,0,0],[7,0,0,0],[0,7,7,0],[0,0,0,0]],"D":[[7,7,0,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"E":[[7,7,7,0],[7,0,0,0],[7,7,0,0],[7,0,0,0],[7,7,7,0],[0,0,0,0]],"F":[[7,7,7,0],[7,0,0,0],[7,7,0,0],[7,0,0,0],[7,0,0,0],[0,0,0,0]],"G":[[0,7,7,0],[7,0,0,0],[7,0,0,0],[7,0,7,0],[7,7,7,0],[0,0,0,0]],"H":[[7,0,7,0],[7,0,7,0],[7,7,7,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"I":[[7,7,7,0],[0,7,0,0],[0,7,0,0],[0,7,0,0],[7,7,7,0],[0,0,0,0]],"J":[[7,7,7,0],[0,7,0,0],[0,7,0,0],[0,7,0,0],[7,7,0,0],[0,0,0,0]],"K":[[7,0,7,0],[7,0,7,0],[7,7,0,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"L":[[7,0,0,0],[7,0,0,0],[7,0,0,0],[7,0,0,0],[7,7,7,0],[0,0,0,0]],"M":[[7,7,7,0],[7,7,7,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"N":[[7,7,0,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"O":[[0,7,7,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,7,0,0],[0,0,0,0]],"P":[[7,7,7,0],[7,0,7,0],[7,7,7,0],[7,0,0,0],[7,0,0,0],[0,0,0,0]],"Q":[[0,7,0,0],[7,0,7,0],[7,0,7,0],[7,7,0,0],[0,7,7,0],[0,0,0,0]],"R":[[7,7,7,0],[7,0,7,0],[7,7,0,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"S":[[0,7,7,0],[7,0,0,0],[7,7,7,0],[0,0,7,0],[7,7,0,0],[0,0,0,0]],"T":[[7,7,7,0],[0,7,0,0],[0,7,0,0],[0,7,0,0],[0,7,0,0],[0,0,0,0]],"U":[[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,0,7,0],[0,7,7,0],[0,0,0,0]],"V":[[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,7,7,0],[0,7,0,0],[0,0,0,0]],"W":[[7,0,7,0],[7,0,7,0],[7,0,7,0],[7,7,7,0],[7,7,7,0],[0,0,0,0]],"X":[[7,0,7,0],[7,0,7,0],[0,7,0,0],[7,0,7,0],[7,0,7,0],[0,0,0,0]],"Y":[[7,0,7,0],[7,0,7,0],[7,7,7,0],[0,0,7,0],[7,7,7,0],[0,0,0,0]],"Z":[[7,7,7,0],[0,0,7,0],[0,7,0,0],[7,0,0,0],[7,7,7,0],[0,0,0,0]],"\"":[[7,0,7,0],[7,0,7,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"'":[[0,7,0,0],[0,7,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"`":[[7,0,0,0],[0,7,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"-":[[0,0,0,0],[0,0,0,0],[0,7,7,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"_":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[7,7,7,0],[0,0,0,0]],"/":[[0,0,7,0],[0,7,0,0],[0,7,0,0],[7,0,0,0],[7,0,0,0],[0,0,0,0]],"!":[[0,7,0,0],[0,7,0,0],[0,7,0,0],[0,0,0,0],[0,7,0,0],[0,0,0,0]],"?":[[7,7,7,0],[0,0,7,0],[0,7,7,0],[0,0,0,0],[0,7,0,0],[0,0,0,0]],"[":[[7,7,0,0],[7,0,0,0],[7,0,0,0],[7,0,0,0],[7,7,0,0],[0,0,0,0]],"]":[[0,7,7,0],[0,0,7,0],[0,0,7,0],[0,0,7,0],[0,7,7,0],[0,0,0,0]],"(":[[0,7,0,0],[7,0,0,0],[7,0,0,0],[7,0,0,0],[0,7,0,0],[0,0,0,0]],")":[[0,7,0,0],[0,0,7,0],[0,0,7,0],[0,0,7,0],[0,7,0,0],[0,0,0,0]],"{":[[0,0,7,0],[0,7,0,0],[7,7,0,0],[0,7,0,0],[0,0,7,0],[0,0,0,0]],"}":[[7,0,0,0],[0,7,0,0],[0,7,7,0],[0,7,0,0],[7,0,0,0],[0,0,0,0]],".":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,7,0,0],[0,0,0,0]],",":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,7,0,0],[7,0,0,0],[0,0,0,0]],";":[[0,0,0,0],[0,7,0,0],[0,0,0,0],[0,7,0,0],[7,0,0,0],[0,0,0,0]],":":[[0,0,0,0],[0,7,0,0],[0,0,0,0],[0,7,0,0],[0,0,0,0],[0,0,0,0]],"<":[[0,0,7,0],[0,7,0,0],[7,0,0,0],[0,7,0,0],[0,0,7,0],[0,0,0,0]],">":[[7,0,0,0],[0,7,0,0],[0,0,7,0],[0,7,0,0],[7,0,0,0],[0,0,0,0]],"+":[[0,0,0,0],[0,7,0,0],[7,7,7,0],[0,7,0,0],[0,0,0,0],[0,0,0,0]],"=":[[0,0,0,0],[7,7,7,0],[0,0,0,0],[7,7,7,0],[0,0,0,0],[0,0,0,0]],"%":[[7,0,7,0],[0,0,7,0],[0,7,0,0],[7,0,0,0],[7,0,7,0],[0,0,0,0]],"#":[[7,0,7,0],[7,7,7,0],[7,0,7,0],[7,7,7,0],[7,0,7,0],[0,0,0,0]],"^":[[0,7,0,0],[7,0,7,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],"*":[[7,0,7,0],[0,7,0,0],[7,7,7,0],[0,7,0,0],[7,0,7,0],[0,0,0,0]],"~":[[0,0,7,0],[7,7,7,0],[7,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]," ":[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}
        };


    RetroScreen.prototype.loadFont = function (fontData, fontId) {
        if (this.fonts === undefined) this.fonts = {0: DEFAULT_FONT};

        this.fonts[fontId] = fontData;
    };

    RetroScreen.prototype.print = function (str, x, y, fontId, c) {
        if (this.fonts === undefined) this.fonts = {0: DEFAULT_FONT};

        str = String(str !== undefined ? str : '');
        fontId = fontId === undefined ? 0 : fontId;

        var self = this;
        var font = this.fonts[fontId];

        if (font.uppercase) str = str.toUpperCase();
        _.each(str.split(''), function (character, i) {
            _.times(font.charH, function (yy) {
                _.times(font.charW, function (xx) {
                    try {
                        var pixel = font.chars[character][yy][xx];
                        if (pixel !== font.transparent) {
                            self.setPixel(x + xx + (i * font.charW), y + yy, c === undefined ? pixel : c);
                        }
                    } catch (err) { }
                });
            });
        });
    };

})(this);